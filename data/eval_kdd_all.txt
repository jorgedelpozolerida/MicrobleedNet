1706705171690 jorge-gram info ClearML Task: created new task id=80773e0abda24da48e0dc2608ae9eb0f
1706705173416 jorge-gram info ClearML results page: https://130.61.76.150:8080/projects/be530161b9324dedab75bdca737621ca/experiments/80773e0abda24da48e0dc2608ae9eb0f/output/log
1706705174914 jorge-gram error 2024-01-31 13:46:14 WARNING  Git repository is not clean. Consider committing changes before running a ClearML task
2024-01-31 13:46:15 INFO     Converting all Path objects in config to relative strings.
1706705176025 jorge-gram info ClearML Monitor: GPU monitoring failed getting GPU reading, switching off GPU monitoring
1706705176343 jorge-gram error 2024-01-31 13:46:16 INFO     Submitting task to remote worker queue single-gpu.
1706705185506 cerebriu-research-bm48gpu-instance-2:gpu3 INFO task 80773e0abda24da48e0dc2608ae9eb0f pulled from b94f6b05a58940f48b30e9bf09fd411b by worker cerebriu-research-bm48gpu-instance-2:gpu3

1706705190674 cerebriu-research-bm48gpu-instance-2:gpu3 DEBUG InsecureRequestWarning: Certificate verification is disabled! Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#ssl-warnings
InsecureRequestWarning: Certificate verification is disabled! Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#ssl-warnings
Current configuration (clearml_agent v1.5.2, location: /tmp/.clearml_agent._v2eu5sz.cfg):
----------------------
agent.worker_id = cerebriu-research-bm48gpu-instance-2:gpu3
agent.worker_name = cerebriu-research-bm48gpu-instance-2
agent.force_git_ssh_protocol = false
agent.python_binary = 
agent.package_manager.type = pip
agent.package_manager.pip_version.0 = <20.2 ; python_version < '3.10'
agent.package_manager.pip_version.1 = <22.3 ; python_version >\= '3.10'
agent.package_manager.system_site_packages = false
agent.package_manager.force_upgrade = false
agent.package_manager.conda_channels.0 = pytorch
agent.package_manager.conda_channels.1 = conda-forge
agent.package_manager.conda_channels.2 = defaults
agent.package_manager.priority_optional_packages.0 = pygobject
agent.package_manager.torch_nightly = false
agent.package_manager.poetry_files_from_repo_working_dir = false
agent.venvs_dir = /4_datadrive/clearml/venvs-builds.4
agent.venvs_cache.max_entries = 10
agent.venvs_cache.free_space_threshold_gb = 2.0
agent.venvs_cache.path = /4_datadrive/clearml/venvs-cache
agent.vcs_cache.enabled = true
agent.vcs_cache.path = /4_datadrive/clearml/vcs-cache
agent.venv_update.enabled = false
agent.pip_download_cache.enabled = true
agent.pip_download_cache.path = /4_datadrive/clearml/pip-download-cache
agent.translate_ssh = true
agent.reload_config = false
agent.docker_pip_cache = /4_datadrive/clearml/pip-cache
agent.docker_apt_cache = /4_datadrive/clearml/apt-cache.4
agent.docker_force_pull = false
agent.default_docker.image = nvidia/cuda:11.0.3-cudnn8-runtime-ubuntu20.04
agent.enable_task_env = false
agent.hide_docker_command_env_vars.enabled = true
agent.hide_docker_command_env_vars.parse_embedded_urls = true
agent.abort_callback_max_timeout = 1800
agent.docker_internal_mounts.sdk_cache = /clearml_agent_cache
agent.docker_internal_mounts.apt_cache = /var/cache/apt/archives
agent.docker_internal_mounts.ssh_folder = ~/.ssh
agent.docker_internal_mounts.ssh_ro_folder = /.ssh
agent.docker_internal_mounts.pip_cache = /root/.cache/pip
agent.docker_internal_mounts.poetry_cache = /root/.cache/pypoetry
agent.docker_internal_mounts.vcs_cache = /root/.clearml/vcs-cache
agent.docker_internal_mounts.venv_build = ~/.clearml/venvs-builds
agent.docker_internal_mounts.pip_download = /root/.clearml/pip-download-cache
agent.apply_environment = true
agent.apply_files = true
agent.custom_build_script = 
agent.disable_task_docker_override = false
agent.git_user = perslev
agent.default_python = 3.11
agent.cuda_version = 114
agent.cudnn_version = 0
api.version = 1.5
api.verify_certificate = false
api.default_version = 1.5
api.http.max_req_size = 15728640
api.http.retries.total = 240
api.http.retries.connect = 240
api.http.retries.read = 240
api.http.retries.redirect = 240
api.http.retries.status = 240
api.http.retries.backoff_factor = 1.0
api.http.retries.backoff_max = 120.0
api.http.wait_on_maintenance_forever = true
api.http.pool_maxsize = 512
api.http.pool_connections = 512
api.api_server = https://130.61.76.150:8008
api.web_server = https://130.61.76.150:8080
api.files_server = s3://cerebriu-research-mlops/clearml/mlops-server
api.credentials.access_key = LA1XBPKXZJ7Q46QYXSL7
api.host = https://130.61.76.150:8008
sdk.storage.cache.default_base_dir = /4_datadrive/clearml/cache
sdk.storage.cache.size.min_free_bytes = 10GB
sdk.storage.direct_access.0.url = file://*
sdk.metrics.file_history_size = 100
sdk.metrics.matplotlib_untitled_history_size = 100
sdk.metrics.images.format = JPEG
sdk.metrics.images.quality = 87
sdk.metrics.images.subsampling = 0
sdk.metrics.tensorboard_single_series_per_graph = false
sdk.network.metrics.file_upload_threads = 4
sdk.network.metrics.file_upload_starvation_warning_sec = 120
sdk.network.iteration.max_retries_on_server_error = 5
sdk.network.iteration.retry_backoff_factor_sec = 10
sdk.network.file_upload_retries = 3
sdk.aws.s3.key = 
sdk.aws.s3.region = 
sdk.aws.s3.credentials.0.bucket = cerebriu-research-mlops
sdk.aws.s3.credentials.0.region = eu-west-1
sdk.aws.s3.credentials.0.key = AKIAYLVE23TZC2PWO4W2
sdk.aws.s3.use_credentials_chain = false
sdk.aws.boto3.pool_connections = 512
sdk.aws.boto3.max_multipart_concurrency = 16
sdk.log.null_log_propagate = false
sdk.log.task_log_buffer_capacity = 66
sdk.log.disable_urllib3_info = true
sdk.development.task_reuse_time_window_in_hours = 72.0
sdk.development.vcs_repo_detect_async = true
sdk.development.store_uncommitted_code_diff = true
sdk.development.support_stopping = true
sdk.development.default_output_uri = 
sdk.development.force_analyze_entire_repo = false
sdk.development.suppress_update_message = false
sdk.development.detect_with_pip_freeze = false
sdk.development.worker.report_period_sec = 2
sdk.development.worker.ping_period_sec = 30
sdk.development.worker.log_stdout = true
sdk.development.worker.report_global_mem_used = false
sdk.development.worker.report_event_flush_threshold = 100
sdk.development.worker.console_cr_flush_period = 10
sdk.apply_environment = false
sdk.apply_files = false

Executing task id [80773e0abda24da48e0dc2608ae9eb0f]:
repository = https://bitbucket.org/cerebriu/cerebriu-research-mlops.git
branch = jorge_dev
version_num = 3a275cce490e48138bd2bf6595fa03886e19f113
tag = 
docker_cmd = 
entry_point = crbr/commands/main.py
working_dir = 


1706705195700 cerebriu-research-bm48gpu-instance-2:gpu3 DEBUG ::: Using Cached environment /4_datadrive/clearml/venvs-cache/9a17d334f9d2c6a8f673d6031acb1c59.d45459cec2442ebeb98213e970574604 :::
Using cached repository in "/4_datadrive/clearml/vcs-cache/cerebriu-research-mlops.git.e69699c1df6f90b3005442a9cd39f36c/cerebriu-research-mlops.git"
Note: switching to '3a275cce490e48138bd2bf6595fa03886e19f113'.

You are in 'detached HEAD' state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by switching back to a branch.

If you want to create a new branch to retain commits you create, you may
do so (now or later) by using -c with the switch command. Example:

  git switch -c <new-branch-name>

Or undo this operation with:

  git switch -

Turn off this advice by setting config variable advice.detachedHead to false

HEAD is now at 3a275cc Added OPTIONAL_CONFIGS
type: git
url: https://bitbucket.org/cerebriu/cerebriu-research-mlops.git
branch: HEAD
commit: 3a275cce490e48138bd2bf6595fa03886e19f113
root: /4_datadrive/clearml/venvs-builds.4/3.11/task_repository/cerebriu-research-mlops.git
Applying uncommitted changes


Adding venv into cache: /4_datadrive/clearml/venvs-builds.4/3.11
Running task id [80773e0abda24da48e0dc2608ae9eb0f]:
[.]$ /4_datadrive/clearml/venvs-builds.4/3.11/bin/python -u crbr/commands/main.py
Summary - installed python packages:
pip:
- absl-py==2.0.0
- antlr4-python3-runtime==4.9.3
- astunparse==1.6.3
- attrs==23.1.0
- bcrypt==4.0.1
- boto3==1.28.79
- botocore==1.31.85
- cachetools==5.3.2
- certifi==2023.11.17
- charset-normalizer==3.3.2
- clearml==1.13.1
- contourpy==1.2.0
- cycler==0.12.1
- Cython==3.0.6
- dipy==1.7.0
- flatbuffers==23.5.26
- fonttools==4.46.0
- furl==2.1.3
- gast==0.5.4
- gitdb==4.0.11
- GitPython==3.1.40
- google-auth==2.24.0
- google-auth-oauthlib==1.0.0
- google-pasta==0.2.0
- grpcio==1.59.3
- h5py==3.10.0
- idna==3.6
- imageio==2.33.0
- jmespath==1.0.1
- joblib==1.3.2
- jsonschema==4.20.0
- jsonschema-specifications==2023.11.2
- keras==2.14.0
- kiwisolver==1.4.5
- lazy_loader==0.3
- libclang==16.0.6
- lxml==4.9.3
- Markdown==3.5.1
- MarkupSafe==2.1.3
- matplotlib==3.8.1
- ml-dtypes==0.2.0
- networkx==3.2.1
- nibabel==5.1.0
- nilearn==0.10.2
- numpy==1.26.2
- oauthlib==3.2.2
- omegaconf==2.3.0
- opt-einsum==3.3.0
- orderedmultidict==1.0.1
- packaging==23.2
- pandas==2.1.3
- pathlib2==2.3.7.post1
- Pillow==10.1.0
- protobuf==4.25.1
- psutil==5.9.6
- pyasn1==0.5.1
- pyasn1-modules==0.3.0
- PyJWT==2.4.0
- pyparsing==3.1.1
- python-dateutil==2.8.2
- pytz==2023.3.post1
- PyYAML==6.0.1
- referencing==0.31.1
- requests==2.31.0
- requests-oauthlib==1.3.1
- rpds-py==0.13.2
- rsa==4.9
- s3transfer==0.7.0
- scikit-image==0.22.0
- scikit-learn==1.3.2
- scipy==1.11.3
- SimpleITK==2.2.1
- six==1.16.0
- smmap==5.0.1
- tensorboard==2.14.1
- tensorboard-data-server==0.7.2
- tensorflow==2.14.0
- tensorflow-estimator==2.14.0
- tensorflow-io-gcs-filesystem==0.34.0
- termcolor==2.4.0
- threadpoolctl==3.2.0
- tifffile==2023.9.26
- tqdm==4.66.1
- typing_extensions==4.8.0
- tzdata==2023.3
- urllib3==2.0.7
- Werkzeug==3.0.1
- wrapt==1.14.1

Environment setup completed successfully

Starting Task Execution:

2024-01-31 12:46:33.910181: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-01-31 12:46:33.910262: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-01-31 12:46:33.910297: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-01-31 12:46:33.918945: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-31 12:46:34.591795: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-01-31 12:46:35 WARNING  InsecureRequestWarning: Certificate verification is disabled! Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#ssl-warnings

1706705200659 cerebriu-research-bm48gpu-instance-2:gpu3 DEBUG ClearML results page: https://130.61.76.150:8080/projects/be530161b9324dedab75bdca737621ca/experiments/80773e0abda24da48e0dc2608ae9eb0f/output/log
2024-01-31 12:46:35 INFO     Running task 80773e0abda24da48e0dc2608ae9eb0f remotely.
2024-01-31 12:46:35 INFO     Fetching config 'args' from ClearML Task '80773e0abda24da48e0dc2608ae9eb0f'.
2024-01-31 12:46:35 INFO     Read config 'args' from ClearML task.
2024-01-31 12:46:35 INFO     Fetching config 'evaluation' from ClearML Task '80773e0abda24da48e0dc2608ae9eb0f'.
2024-01-31 12:46:36 INFO     Read config 'evaluation' from ClearML task.
2024-01-31 12:46:36 INFO     Fetching config 'experiment' from ClearML Task '80773e0abda24da48e0dc2608ae9eb0f'.
2024-01-31 12:46:36 INFO     Read config 'experiment' from ClearML task.
2024-01-31 12:46:36 INFO     Running with ClearML mode: 'remote'
2024-01-31 12:46:36 INFO     Parsed arguments: {'add_evaluations_to_model': False, 'clearml_mode': 'remote', 'command': 'evaluate', 'dataset_id': None, 'evaluations': ['segmentation', 'accumulated_segmentation', 'classification', 'accumulated_classification', 'counts', 'accumulated_counts'], 'local_run_dir': None, 'log_level': 'INFO', 'model_id': None, 'prediction_task_id': '648a8367969a4dcabf77aa6d15286122', 'project_folder': '.', 'project_name': 'CMB/KDD', 'seed': 42, 'splits': None, 'splits_file': None, 'study_folders_pattern': '*', 'tags': ['kdd', 'best', 'CRB_cmb_T2S'], 'task_description': None, 'task_name': 'kdd-T2S-eval', 'tf_min_log_level': '2', 'worker_queue_name': 'single-gpu'}
2024-01-31 12:46:36 INFO     Setting global seed to 42
2024-01-31 12:46:36 INFO     Importing module 'crbr.commands.evaluate'
2024-01-31 12:46:36 INFO     Running command: evaluate in module crbr.commands.evaluate (task=80773e0abda24da48e0dc2608ae9eb0f) from dir /tmp/tmpnh2innzh/CMB/KDD/kdd-T2S-eval
2024-01-31 12:46:36 INFO     Setting task 80773e0abda24da48e0dc2608ae9eb0f type to 'testing'
2024-01-31 12:46:36 INFO     Prediction task 648a8367969a4dcabf77aa6d15286122 has 1 prediction artefact(s).
2024-01-31 12:46:36 INFO     Found prediction artefact with model_id 10142675e5de427793e963efc6474009 and dataset_id 897b41b37df84ceb893214f087689c05. Running evaluation now.
2024-01-31 12:46:37 INFO     Stotred local copy of artefact 'prediction-10142675e5de427793e963efc6474009-897b41b37df84ceb893214f087689c05-all' in folder '/4_datadrive/clearml/cache/storage_manager/global/8e57119fc382656b8fbf8c3ed14f98ba.kdd-T2S-predict_artifacts_archive_prediction-10142675e5de427793e963efc6474009-897b41b37df84ceb893214f087689c05-all'
2024-01-31 12:46:37,288 - clearml - INFO - Dataset.get() did not specify alias. Dataset information will not be automatically logged in ClearML Server.
2024-01-31 12:46:37 INFO     Dataset not locally available. Attempting to automatically download.
2024-01-31 12:46:37 INFO     Fetching dataset: [ID=None, name='CRB_cmb_T2S', version=1] from ClearML
2024-01-31 12:46:37 INFO     Dataset has tags: ['T2S-space', 'isotropic=0.5', 'nifty', 'processed']
2024-01-31 12:46:37 INFO     Dataset is not zipped. Leaving in as-is in default ClearML cache.
2024-01-31 12:46:37 INFO     Dataset downloaded to /4_datadrive/clearml/cache/storage_manager/datasets/ds_897b41b37df84ceb893214f087689c05
2024-01-31 12:46:37 INFO     Found 4 study folders.
2024-01-31 12:46:37 INFO     Creating dataset for split all with 4 studies.
2024-01-31 12:46:37 INFO     Vectorized label map in config 'segmentation'.
2024-01-31 12:46:37 INFO     Loaded dataset split all with 4 samples.
2024-01-31 12:46:37 INFO     Loaded dataset with 1 splits: {'all': MRIStudyDataset(len(mri_study_specs)=4, load_sequence_spec=SequenceSpec(T2S), metadata=False, transform=False)}
2024-01-31 12:46:37 INFO     Initialized running evaluation for split 'all' (dataset MRIStudyDataset(len(mri_study_specs)=4, load_sequence_spec=SequenceSpec(T2S), metadata=False, transform=False))
2024-01-31 12:46:37 INFO     Found 4 prediction files for 4 studies.
2024-01-31 12:46:37 INFO     Getting segmentation to classification converter pixel_count with kwargs {'n_classes': 2, 'conversion_map': None}
2024-01-31 12:46:37 INFO     Using pixel thresholds: {1: 1}
2024-01-31 12:46:37 INFO     Using segmentation -> classification converter: PixelCountSegmentationToClassificationConverter({'conversion_map': None, 'num_pixels_thresholds': {1: 1}, 'negative_class_index': 0, 'max_class_in_map': 1, 'n_classes': 2})
2024-01-31 12:46:37 INFO     Evaluating 4 predictions with 6 evaluation(s):
                             - SegmentationEvaluation({'zero_division': nan, 'ignore_classes_in_avg': (0,)})
                             - AccumulatedSegmentationEvaluation({'zero_division': nan, 'ignore_classes_in_avg': (0,)})
                             - ClassificationEvaluation({})
                             - AcccumulatedClassificationEvaluation({})
                             - CountsEvaluation({'label_structure': array([[[ True,  True,  True],
                                     [ True,  True,  True],
                                     [ True,  True,  True]],
                             
                                    [[ True,  True,  True],
                                     [ True,  True,  True],
                                     [ True,  True,  True]],
                             
                                    [[ True,  True,  True],
                                     [ True,  True,  True],
                                     [ True,  True,  True]]]), 'min_overlap_voxels': 1})
                             - AccumulatedCountsEvaluation({'label_structure': array([[[ True,  True,  True],
                                     [ True,  True,  True],
                                     [ True,  True,  True]],
                             
                                    [[ True,  True,  True],
                                     [ True,  True,  True],
                                     [ True,  True,  True]],
                             
                                    [[ True,  True,  True],
                                     [ True,  True,  True],
                                     [ True,  True,  True]]]), 'min_overlap_voxels': 1})
2024-01-31 12:46:38 INFO     [1/4] Evaluating study 1.2.826.1.3680043.9.5282.150415.14832.16014832222376.

1706705210665 cerebriu-research-bm48gpu-instance-2:gpu3 DEBUG 2024-01-31 12:46:47 INFO     Study evaluation:
                             {'classification': {0: 'TN',
                                                 1: 'TP'},
                              'counts': {'predicted_counts': {1: 26},
                                         'predicted_overlapping_counts': {1: 9},
                                         'true_counts': {1: 11}},
                              'segmentation': {'f1_0': 0.9999448560265527,
                                               'f1_1': 0.4372801875732708,
                                               'f1_avg': 0.4372801875732708,
                                               'precision_0': 0.9999511360055378,
                                               'precision_1': 0.4109438119720896,
                                               'precision_avg': 0.4109438119720896,
                                               'recall_0': 0.9999385761264474,
                                               'recall_1': 0.467223382045929,
                                               'recall_avg': 0.467223382045929,
                                               'specificity_0': 0.467223382045929,
                                               'specificity_1': 0.9999385761264474,
                                               'specificity_avg': 0.9999385761264474}}
2024-01-31 12:46:47 INFO     [2/4] Evaluating study 1.2.826.1.3680043.9.5282.150415.34194.3419422232714.

1706705220693 cerebriu-research-bm48gpu-instance-2:gpu3 DEBUG 2024-01-31 12:46:58 INFO     Study evaluation:
                             {'classification': {0: 'TN',
                                                 1: 'TP'},
                              'counts': {'predicted_counts': {1: 31},
                                         'predicted_overlapping_counts': {1: 5},
                                         'true_counts': {1: 18}},
                              'segmentation': {'f1_0': 0.9999066420282235,
                                               'f1_1': 0.1562547966231773,
                                               'f1_avg': 0.1562547966231773,
                                               'precision_0': 0.9999206182901098,
                                               'precision_1': 0.13872989915508313,
                                               'precision_avg': 0.13872989915508313,
                                               'recall_0': 0.9998926661570348,
                                               'recall_1': 0.17884750527055515,
                                               'recall_avg': 0.17884750527055515,
                                               'specificity_0': 0.17884750527055515,
                                               'specificity_1': 0.9998926661570348,
                                               'specificity_avg': 0.9998926661570348}}
2024-01-31 12:46:59 INFO     [3/4] Evaluating study 1.2.826.1.3680043.9.5282.150415.650.650232327158.

1706705230719 cerebriu-research-bm48gpu-instance-2:gpu3 DEBUG 2024-01-31 12:47:10 INFO     Study evaluation:
                             {'classification': {0: 'TN',
                                                 1: 'TP'},
                              'counts': {'predicted_counts': {1: 37},
                                         'predicted_overlapping_counts': {1: 10},
                                         'true_counts': {1: 13}},
                              'segmentation': {'f1_0': 0.9999676670167159,
                                               'f1_1': 0.4660510592069527,
                                               'f1_avg': 0.4660510592069527,
                                               'precision_0': 0.9999838496930734,
                                               'precision_1': 0.367766823831976,
                                               'precision_avg': 0.367766823831976,
                                               'recall_0': 0.9999514848641163,
                                               'recall_1': 0.6360266864343959,
                                               'recall_avg': 0.6360266864343959,
                                               'specificity_0': 0.6360266864343959,
                                               'specificity_1': 0.9999514848641163,
                                               'specificity_avg': 0.9999514848641163}}

1706705235720 cerebriu-research-bm48gpu-instance-2:gpu3 DEBUG 2024-01-31 12:47:10 INFO     [4/4] Evaluating study 42a2a5865709f9ddc47da60a1556f09552586685.

1706705245820 cerebriu-research-bm48gpu-instance-2:gpu3 DEBUG 2024-01-31 12:47:21 INFO     Study evaluation:
                             {'classification': {0: 'TN',
                                                 1: 'TP'},
                              'counts': {'predicted_counts': {1: 14},
                                         'predicted_overlapping_counts': {1: 5},
                                         'true_counts': {1: 6}},
                              'segmentation': {'f1_0': 0.9999754145950924,
                                               'f1_1': 0.39920792079207923,
                                               'f1_avg': 0.39920792079207923,
                                               'precision_0': 0.9999823022761509,
                                               'precision_1': 0.3416949152542373,
                                               'precision_avg': 0.3416949152542373,
                                               'recall_0': 0.9999685270089151,
                                               'recall_1': 0.48,
                                               'recall_avg': 0.48,
                                               'specificity_0': 0.48,
                                               'specificity_1': 0.9999685270089151,
                                               'specificity_avg': 0.9999685270089151}}
2024-01-31 12:47:21 INFO     Accumulated evaluation ('accumulated_segmentation'):
                             {'confusion_matrix': array([[116802002,      7210],
                                    [     4650,      2990]]),
                              'f1_0': 0.9999492328996973,
                              'f1_1': 0.3352017937219731,
                              'f1_avg': 0.3352017937219731,
                              'precision_0': 0.9999601906233901,
                              'precision_1': 0.2931372549019608,
                              'precision_avg': 0.2931372549019608,
                              'recall_0': 0.9999382754161547,
                              'recall_1': 0.3913612565445026,
                              'recall_avg': 0.3913612565445026,
                              'specificity_0': 0.3913612565445026,
                              'specificity_1': 0.9999382754161547,
                              'specificity_avg': 0.9999382754161547}
2024-01-31 12:47:21 INFO     Accumulated evaluation ('accumulated_classification'):
                             {'confusion_matrix_0': array([[4, 0],
                                    [0, 0]]),
                              'confusion_matrix_1': array([[0, 0],
                                    [0, 4]]),
                              'f1_0': nan,
                              'f1_1': 1.0,
                              'precision_0': nan,
                              'precision_1': 1.0,
                              'recall_0': nan,
                              'recall_1': 1.0,
                              'specificity_0': 1.0,
                              'specificity_1': nan}
Traceback (most recent call last):
  File "/4_datadrive/clearml/venvs-builds.4/3.11/task_repository/cerebriu-research-mlops.git/crbr/commands/main.py", line 222, in <module>
    main()
  File "/4_datadrive/clearml/venvs-builds.4/3.11/task_repository/cerebriu-research-mlops.git/crbr/commands/main.py", line 218, in main
    return mod.main(task=task, config=config, local_run_dir=local_run_dir)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/4_datadrive/clearml/venvs-builds.4/3.11/task_repository/cerebriu-research-mlops.git/crbr/utils/config_utils.py", line 544, in wrapper
    return func(task, config, local_run_dir, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/4_datadrive/clearml/venvs-builds.4/3.11/task_repository/cerebriu-research-mlops.git/crbr/utils/clearml_utils.py", line 477, in wrapper
    return func(task, config, local_run_dir, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/4_datadrive/clearml/venvs-builds.4/3.11/task_repository/cerebriu-research-mlops.git/crbr/commands/evaluate.py", line 453, in main
    evaluate_prediction_artefact(
  File "/4_datadrive/clearml/venvs-builds.4/3.11/task_repository/cerebriu-research-mlops.git/crbr/commands/evaluate.py", line 352, in evaluate_prediction_artefact
    evaluation_metrics = run_all_evaluations_on_dataset(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/4_datadrive/clearml/venvs-builds.4/3.11/task_repository/cerebriu-research-mlops.git/crbr/commands/evaluate.py", line 229, in run_all_evaluations_on_dataset
    add_accumulated_metrics(evaluation_metrics, evaluations, task)
  File "/4_datadrive/clearml/venvs-builds.4/3.11/task_repository/cerebriu-research-mlops.git/crbr/commands/evaluate.py", line 247, in add_accumulated_metrics
    accumulated_eval = evaluation.get_accumulated_evaluation()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/4_datadrive/clearml/venvs-builds.4/3.11/task_repository/cerebriu-research-mlops.git/crbr/evaluation/evaluations/counts_evaluation.py", line 231, in get_accumulated_evaluation
    results_with_stats[class_label]['true_positives'] - results_with_stats[class_label]['true_counts']
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'list' and 'list'

1706705255784 cerebriu-research-bm48gpu-instance-2:gpu3 DEBUG Process failed, exit code 1
